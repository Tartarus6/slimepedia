<script lang="ts">
	import { onMount } from 'svelte';
	import { soundManager } from '$lib/scripts/sound';
	import '../app.css';

	let { children } = $props();

	let userHasInteracted = $state(false);

	// Initialize audio context on first user interaction to avoid browser warnings
	const initAudioOnInteraction = () => {
		soundManager.initializeOnUserGesture();
		userHasInteracted=true
	};

	onMount(() => {		
		// Listen for any user interaction to initialize audio
		// Use capture phase to ensure we catch the event early
		// Don't use { once: true } because we want to persist across navigation
		// window.addEventListener('click', initAudioOnInteraction, { capture: true });
		// window.addEventListener('touchstart', initAudioOnInteraction, { capture: true });
		// window.addEventListener('keydown', initAudioOnInteraction, { capture: true });

		return () => {
			// Clean up listeners on component destroy
			if (window) {
				window.removeEventListener('click', initAudioOnInteraction, { capture: true });
				window.removeEventListener('touchstart', initAudioOnInteraction, { capture: true });
				window.removeEventListener('keydown', initAudioOnInteraction, { capture: true });
			}
		};
	});

</script>

<svelte:head>
	<title>Slimepedia</title>
	<link rel="icon" type="image/png" href="/favicon.png" />
	<meta name="viewport" content="width=device-width, initial-scale=1" />
</svelte:head>


<div class="grid h-screen w-screen place-content-center justify-items-center">
	<!-- Interaction request for audio -->
	{#if !userHasInteracted}
		<button aria-label="play sound request button" class="absolute z-50 w-full h-full" onmousedown={initAudioOnInteraction} ontouchstart={initAudioOnInteraction} onkeydown={initAudioOnInteraction}>
			<div class="flex h-full w-full items-center justify-center">
				<div class="bg-black opacity-80 p-20 flex flex-col rounded-lg text-center gap-6">
					<span class="text-3xl font-bold text-white!">Press Any Button</span>
					<span class="text-lg italic text-white">(Required for audio playback)</span>
				</div>
			</div>
		</button>
	{/if}

	<!-- Main page content -->
	<div
		class="mx-5 my-10 grid h-[56em] w-[96em] grid-cols-1 grid-rows-1 overflow-y-hidden overflow-x-hidden rounded-page bg-lighter-beige shadow-xl ring-1 ring-slate-900/5"
	>
		<svg
			class="animate-wave left-0 top-0 z-0 col-start-1 row-start-1 h-full w-[200%]"
			viewBox="0 0 800 250"
			preserveAspectRatio="none"
		>
			<path
				d="M 0,100 L 0,166.66666666666666 1,167.1378861860213 2,167.60898943901051 3,168.07986018795594
			4,168.55038225254606 5,169.02043953850202 6,169.4899160662221 7,169.958695999398
			8,170.42666367359578 9,170.89370362479414 10,171.35970061787359 11,171.82453967504895
			12,172.2881061042384 13,172.75028552736202 14,173.21096390856295 15,173.6700275823438
			16,174.1273632816123 17,174.58285816562784 18,175.03639984784354 19,175.48787642363578
			20,175.9371764979151 21,176.38418921261115 22,176.8288042740254 23,177.27091198004436
			24,177.71040324720698 25,178.14716963761936 26,178.58110338571007 27,179.01209742481993
			28,179.44004541361883 29,179.8648417623441 30,180.28638165885306 31,180.70456109448386
			32,181.11927688971812 33,181.53042671963888 34,181.9379091391778 35,182.3416236081451
			36,182.74147051603654 37,183.13735120661062 38,183.52916800223056 39,183.916824227965
			40,184.30022423544085 41,184.67927342644316 42,185.05387827625594 43,185.42394635673782
			44,185.78938635912735 45,186.15010811657217 46,186.50602262637622 47,186.85704207195985
			48,187.2030798445273 49,187.54405056443608 50,187.87987010226308 51,188.21045559956232
			52,188.53572548930902 53,188.85559951602494 54,189.16999875558045 55,189.47884563466758
			56,189.78206394994032 57,190.07957888681653 58,190.37131703793736 59,190.65720642127937
			60,190.9371764979151 61,191.21115818941735 62,191.4790838949035 63,191.74088750771477
			64,191.99650443172712 65,192.2458715972894 66,192.48892747678497 67,192.7256120998124
			68,192.95586706798258 69,193.17963556932747 70,193.3968623923177 71,193.60749393948512
			72,193.81147824064723 73,194.00876496573002 74,194.1993054371861 75,194.38305264200525
			76,194.5599612433142 77,194.7299875915627 78,194.89308973529342 79,195.04922743149302
			80,195.19836215552127 81,195.34045711061657 82,195.47547723697494 83,195.6033892204006
			84,195.72416150052558 85,195.83776427859695 86,195.94416952482908 87,196.04335098531962
			88,196.13528418852732 89,196.21994645130988 90,196.2973168845208 91,196.36737639816337
			92,196.43010770610098 93,196.48549533032204 94,196.53352560475906 95,196.5741866786605
			96,196.6074685195148 97,196.63336291552577 98,196.6518634776386 99,196.66296564111647
			100,196.66666666666666 101,196.66296564111647 102,196.6518634776386 103,196.63336291552577
			104,196.6074685195148 105,196.5741866786605 106,196.53352560475906 107,196.48549533032204
			108,196.43010770610098 109,196.3673763981634 110,196.2973168845208 111,196.21994645130988
			112,196.13528418852732 113,196.04335098531965 114,195.94416952482908 115,195.83776427859695
			116,195.72416150052558 117,195.6033892204006 118,195.47547723697494 119,195.34045711061657
			120,195.19836215552127 121,195.04922743149302 122,194.89308973529342 123,194.7299875915627
			124,194.5599612433142 125,194.38305264200525 126,194.1993054371861 127,194.00876496573002
			128,193.81147824064723 129,193.60749393948512 130,193.3968623923177 131,193.17963556932747
			132,192.95586706798255 133,192.7256120998124 134,192.48892747678497 135,192.24587159728944
			136,191.99650443172712 137,191.74088750771477 138,191.4790838949035 139,191.21115818941735
			140,190.9371764979151 141,190.65720642127937 142,190.37131703793736 143,190.07957888681653
			144,189.78206394994032 145,189.47884563466758 146,189.16999875558045 147,188.85559951602494
			148,188.53572548930902 149,188.21045559956232 150,187.87987010226308 151,187.54405056443608
			152,187.20307984452734 153,186.85704207195985 154,186.50602262637622 155,186.15010811657217
			156,185.78938635912735 157,185.42394635673782 158,185.05387827625594 159,184.6792734264432
			160,184.30022423544085 161,183.916824227965 162,183.5291680022306 163,183.13735120661062
			164,182.74147051603657 165,182.34162360814514 166,181.9379091391778 167,181.53042671963888
			168,181.11927688971812 169,180.70456109448386 170,180.28638165885306 171,179.86484176234413
			172,179.44004541361883 173,179.01209742481993 174,178.5811033857101 175,178.14716963761936
			176,177.710403247207 177,177.27091198004436 178,176.8288042740254 179,176.38418921261115
			180,175.9371764979151 181,175.48787642363578 182,175.03639984784354 183,174.58285816562784
			184,174.1273632816123 185,173.67002758234383 186,173.21096390856295 187,172.75028552736202
			188,172.2881061042384 189,171.82453967504895 190,171.35970061787359 191,170.89370362479414
			192,170.42666367359578 193,169.95869599939803 194,169.4899160662221 195,169.02043953850202
			196,168.55038225254606 197,168.07986018795594 198,167.60898943901051 199,167.1378861860213
			200,166.66666666666666 201,166.19544714731205 202,165.72434389432283 203,165.25347314537737
			204,164.78295108078726 205,164.31289379483133 206,163.84341726711122 207,163.3746373339353
			208,162.90666965973753 209,162.43962970853917 210,161.97363271545973 211,161.5087936582844
			212,161.0452272290949 213,160.5830478059713 214,160.12236942477037 215,159.6633057509895
			216,159.205970051721 217,158.75047516770547 218,158.2969334854898 219,157.84545690969753
			220,157.39615683541825 221,156.94914412072217 222,156.5045290593079 223,156.06242135328895
			224,155.62293008612633 225,155.18616369571396 226,154.75222994762325 227,154.32123590851342
			228,153.89328791971448 229,153.46849157098922 230,153.04695167448025 231,152.62877223884945
			232,152.2140564436152 233,151.80290661369443 234,151.3954241941555 235,150.9917097251882
			236,150.59186281729677 237,150.19598212672273 238,149.80416533110275 239,149.4165091053683
			240,149.03310909789246 241,148.65405990689013 242,148.27945505707737 243,147.9093869765955
			244,147.54394697420597 245,147.18322521676114 246,146.82731070695712 247,146.47629126137346
			248,146.130253488806 249,145.78928276889724 250,145.45346323107026 251,145.122877733771
			252,144.7976078440243 253,144.47773381730838 254,144.16333457775286 255,143.8544876986657
			256,143.551269383393 257,143.25375444651675 258,142.96201629539596 259,142.67612691205395
			260,142.39615683541822 261,142.12217514391597 262,141.8542494384298 263,141.59244582561854
			264,141.3368289016062 265,141.08746173604388 266,140.84440585654835 267,140.60772123352092
			268,140.37746626535076 269,140.15369776400587 270,139.9364709410156 271,139.7258393938482
			272,139.52185509268605 273,139.3245683676033 274,139.13402789614722 275,138.95028069132806
			276,138.7733720900191 277,138.60334574177062 278,138.4402435980399 279,138.2841059018403
			280,138.13497117781205 281,137.99287622271675 282,137.85785609635838 283,137.7299441129327
			284,137.60917183280773 285,137.49556905473636 286,137.38916380850424 287,137.2899823480137
			288,137.198049144806 289,137.11338688202343 290,137.03601644881252 291,136.96595693516994
			292,136.90322562723233 293,136.84783800301128 294,136.79980772857425 295,136.7591466546728
			296,136.7258648138185 297,136.69997041780755 298,136.6814698556947 299,136.67036769221684
			300,136.66666666666666 301,136.67036769221684 302,136.6814698556947 303,136.69997041780755
			304,136.7258648138185 305,136.7591466546728 306,136.79980772857425 307,136.84783800301128
			308,136.90322562723233 309,136.96595693516994 310,137.03601644881252 311,137.11338688202343
			312,137.198049144806 313,137.28998234801367 314,137.38916380850424 315,137.49556905473636
			316,137.60917183280773 317,137.7299441129327 318,137.85785609635838 319,137.99287622271675
			320,138.13497117781205 321,138.2841059018403 322,138.4402435980399 323,138.60334574177062
			324,138.7733720900191 325,138.95028069132803 326,139.13402789614722 327,139.3245683676033
			328,139.52185509268605 329,139.7258393938482 330,139.9364709410156 331,140.15369776400584
			332,140.37746626535076 333,140.60772123352092 334,140.84440585654835 335,141.08746173604388
			336,141.3368289016062 337,141.59244582561854 338,141.8542494384298 339,142.12217514391594
			340,142.39615683541822 341,142.67612691205392 342,142.96201629539593 343,143.25375444651678
			344,143.55126938339296 345,143.85448769866574 346,144.16333457775286 347,144.47773381730838
			348,144.7976078440243 349,145.122877733771 350,145.4534632310702 351,145.7892827688972
			352,146.13025348880598 353,146.47629126137343 354,146.82731070695712 355,147.18322521676114
			356,147.54394697420597 357,147.90938697659547 358,148.27945505707737 359,148.6540599068901
			360,149.03310909789246 361,149.4165091053683 362,149.80416533110272 363,150.19598212672273
			364,150.59186281729674 365,150.9917097251882 366,151.3954241941555 367,151.80290661369443
			368,152.21405644361516 369,152.62877223884945 370,153.04695167448025 371,153.4684915709892
			372,153.89328791971445 373,154.3212359085134 374,154.75222994762325 375,155.18616369571396
			376,155.62293008612633 377,156.06242135328893 378,156.5045290593079 379,156.94914412072217
			380,157.39615683541822 381,157.84545690969753 382,158.29693348548977 383,158.75047516770545
			384,159.205970051721 385,159.6633057509895 386,160.12236942477037 387,160.5830478059713
			388,161.0452272290949 389,161.50879365828436 390,161.97363271545973 391,162.43962970853917
			392,162.90666965973753 393,163.37463733393528 394,163.84341726711122 395,164.3128937948313
			396,164.78295108078726 397,165.25347314537737 398,165.7243438943228 399,166.19544714731202
			400,166.66666666666666 401,167.13788618602126 402,167.6089894390105 403,168.07986018795592
			404,168.55038225254603 405,169.020439538502 406,169.4899160662221 407,169.958695999398
			408,170.42666367359578 409,170.89370362479414 410,171.35970061787359 411,171.82453967504892
			412,172.28810610423838 413,172.75028552736202 414,173.21096390856292 415,173.67002758234383
			416,174.1273632816123 417,174.58285816562784 418,175.03639984784354 419,175.48787642363578
			420,175.93717649791506 421,176.38418921261112 422,176.8288042740254 423,177.27091198004436
			424,177.710403247207 425,178.14716963761933 426,178.58110338571007 427,179.01209742481993
			428,179.44004541361883 429,179.8648417623441 430,180.28638165885306 431,180.70456109448384
			432,181.1192768897181 433,181.53042671963888 434,181.93790913917778 435,182.34162360814514
			436,182.74147051603654 437,183.13735120661062 438,183.52916800223056 439,183.916824227965
			440,184.30022423544085 441,184.67927342644316 442,185.05387827625597 443,185.42394635673782
			444,185.78938635912735 445,186.15010811657214 446,186.50602262637622 447,186.85704207195982
			448,187.2030798445273 449,187.54405056443608 450,187.87987010226308 451,188.21045559956232
			452,188.535725489309 453,188.85559951602497 454,189.16999875558042 455,189.47884563466758
			456,189.78206394994032 457,190.07957888681653 458,190.37131703793736 459,190.65720642127937
			460,190.9371764979151 461,191.21115818941735 462,191.4790838949035 463,191.74088750771475
			464,191.99650443172712 465,192.2458715972894 466,192.48892747678497 467,192.7256120998124
			468,192.95586706798255 469,193.17963556932744 470,193.3968623923177 471,193.60749393948512
			472,193.81147824064723 473,194.00876496573002 474,194.19930543718607 475,194.38305264200525
			476,194.5599612433142 477,194.7299875915627 478,194.89308973529342 479,195.04922743149302
			480,195.19836215552124 481,195.34045711061657 482,195.47547723697494 483,195.6033892204006
			484,195.72416150052558 485,195.83776427859695 486,195.94416952482908 487,196.04335098531962
			488,196.13528418852732 489,196.21994645130988 490,196.2973168845208 491,196.3673763981634
			492,196.43010770610098 493,196.48549533032204 494,196.53352560475906 495,196.5741866786605
			496,196.6074685195148 497,196.63336291552577 498,196.6518634776386 499,196.66296564111647
			500,196.66666666666666 501,196.66296564111647 502,196.6518634776386 503,196.63336291552577
			504,196.6074685195148 505,196.5741866786605 506,196.53352560475906 507,196.48549533032207
			508,196.43010770610098 509,196.3673763981634 510,196.2973168845208 511,196.21994645130988
			512,196.13528418852732 513,196.04335098531965 514,195.94416952482908 515,195.83776427859695
			516,195.72416150052558 517,195.6033892204006 518,195.47547723697494 519,195.34045711061657
			520,195.19836215552127 521,195.04922743149302 522,194.89308973529342 523,194.7299875915627
			524,194.5599612433142 525,194.38305264200525 526,194.19930543718607 527,194.00876496573002
			528,193.81147824064723 529,193.60749393948512 530,193.39686239231767 531,193.17963556932747
			532,192.95586706798255 533,192.7256120998124 534,192.48892747678497 535,192.2458715972894
			536,191.99650443172712 537,191.74088750771475 538,191.4790838949035 539,191.21115818941735
			540,190.9371764979151 541,190.65720642127937 542,190.3713170379374 543,190.07957888681653
			544,189.78206394994032 545,189.47884563466758 546,189.16999875558042 547,188.85559951602494
			548,188.535725489309 549,188.21045559956232 550,187.87987010226306 551,187.5440505644361
			552,187.2030798445273 553,186.85704207195988 554,186.5060226263762 555,186.15010811657214
			556,185.78938635912735 557,185.4239463567378 558,185.05387827625594 559,184.67927342644316
			560,184.30022423544085 561,183.916824227965 562,183.5291680022306 563,183.1373512066106
			564,182.74147051603657 565,182.3416236081451 566,181.93790913917778 567,181.53042671963888
			568,181.1192768897181 569,180.70456109448386 570,180.28638165885303 571,179.86484176234413
			572,179.44004541361883 573,179.01209742481993 574,178.58110338571007 575,178.14716963761938
			576,177.71040324720698 577,177.27091198004436 578,176.8288042740254 579,176.38418921261112
			580,175.9371764979151 581,175.48787642363575 582,175.03639984784354 583,174.58285816562784
			584,174.12736328161233 585,173.6700275823438 586,173.21096390856297 587,172.75028552736202
			588,172.28810610423838 589,171.82453967504895 590,171.35970061787356 591,170.89370362479414
			592,170.42666367359578 593,169.95869599939803 594,169.4899160662221 595,169.02043953850202
			596,168.55038225254606 597,168.07986018795597 598,167.60898943901051 599,167.13788618602126
			600,166.66666666666666 601,166.19544714731202 602,165.72434389432283 603,165.25347314537737
			604,164.78295108078729 605,164.3128937948313 606,163.84341726711125 607,163.3746373339353
			608,162.90666965973756 609,162.43962970853917 610,161.97363271545973 611,161.5087936582844
			612,161.0452272290949 613,160.5830478059713 614,160.12236942477037 615,159.6633057509895
			616,159.205970051721 617,158.7504751677055 618,158.29693348548977 619,157.84545690969753
			620,157.39615683541825 621,156.94914412072217 622,156.50452905930794 623,156.06242135328893
			624,155.62293008612633 625,155.18616369571396 626,154.75222994762328 627,154.3212359085134
			628,153.8932879197145 629,153.46849157098922 630,153.04695167448023 631,152.62877223884948
			632,152.2140564436152 633,151.80290661369446 634,151.3954241941555 635,150.9917097251882
			636,150.59186281729677 637,150.19598212672273 638,149.80416533110275 639,149.41650910536833
			640,149.03310909789246 641,148.65405990689013 642,148.27945505707737 643,147.9093869765955
			644,147.543946974206 645,147.18322521676114 646,146.82731070695712 647,146.47629126137346
			648,146.13025348880603 649,145.78928276889724 650,145.45346323107026 651,145.122877733771
			652,144.79760784402436 653,144.47773381730835 654,144.16333457775286 655,143.85448769866574
			656,143.55126938339302 657,143.25375444651675 658,142.96201629539596 659,142.67612691205397
			660,142.39615683541828 661,142.12217514391594 662,141.8542494384298 663,141.59244582561857
			664,141.3368289016062 665,141.08746173604388 666,140.84440585654835 667,140.60772123352095
			668,140.37746626535073 669,140.15369776400587 670,139.93647094101564 671,139.72583939384822
			672,139.52185509268605 673,139.32456836760332 674,139.13402789614724 675,138.95028069132803
			676,138.7733720900191 677,138.60334574177065 678,138.4402435980399 679,138.2841059018403
			680,138.13497117781205 681,137.99287622271677 682,137.85785609635838 683,137.7299441129327
			684,137.60917183280773 685,137.49556905473636 686,137.38916380850424 687,137.2899823480137
			688,137.198049144806 689,137.11338688202346 690,137.03601644881252 691,136.96595693516994
			692,136.90322562723233 693,136.84783800301128 694,136.79980772857425 695,136.75914665467283
			696,136.7258648138185 697,136.69997041780755 698,136.6814698556947 699,136.67036769221684
			700,136.66666666666666 701,136.67036769221684 702,136.6814698556947 703,136.69997041780755
			704,136.7258648138185 705,136.7591466546728 706,136.79980772857425 707,136.84783800301125
			708,136.90322562723233 709,136.9659569351699 710,137.03601644881252 711,137.11338688202343
			712,137.198049144806 713,137.28998234801367 714,137.38916380850424 715,137.49556905473636
			716,137.60917183280773 717,137.7299441129327 718,137.85785609635835 719,137.99287622271675
			720,138.13497117781205 721,138.2841059018403 722,138.4402435980399 723,138.60334574177062
			724,138.7733720900191 725,138.95028069132803 726,139.13402789614724 727,139.3245683676033
			728,139.52185509268605 729,139.7258393938482 730,139.9364709410156 731,140.15369776400584
			732,140.37746626535073 733,140.60772123352092 734,140.84440585654835 735,141.08746173604388
			736,141.33682890160617 737,141.59244582561857 738,141.8542494384298 739,142.12217514391594
			740,142.39615683541822 741,142.67612691205395 742,142.96201629539593 743,143.25375444651672
			744,143.55126938339296 745,143.85448769866574 746,144.16333457775286 747,144.47773381730838
			748,144.79760784402433 749,145.122877733771 750,145.4534632310702 751,145.7892827688972
			752,146.130253488806 753,146.47629126137343 754,146.82731070695706 755,147.18322521676112
			756,147.54394697420597 757,147.90938697659547 758,148.27945505707737 759,148.65405990689015
			760,149.03310909789246 761,149.41650910536828 762,149.80416533110272 763,150.1959821267227
			764,150.59186281729674 765,150.9917097251882 766,151.39542419415548 767,151.80290661369443
			768,152.21405644361516 769,152.62877223884945 770,153.04695167448025 771,153.4684915709892
			772,153.89328791971442 773,154.3212359085134 774,154.75222994762325 775,155.18616369571393
			776,155.6229300861263 777,156.06242135328893 778,156.5045290593079 779,156.94914412072214
			780,157.39615683541822 781,157.84545690969756 782,158.29693348548977 783,158.75047516770547
			784,159.20597005172098 785,159.66330575098948 786,160.12236942477034 787,160.5830478059713
			788,161.04522722909488 789,161.50879365828436 790,161.9736327154597 791,162.43962970853917
			792,162.90666965973753 793,163.37463733393528 794,163.84341726711122 795,164.31289379483127
			796,164.78295108078726 797,165.25347314537734 798,165.7243438943228 799,166.195447147312 800,1500
			0,1500"
				fill="#eaddc8"
				stroke-width="2"
			/>
		</svg>
		<div class="z-10 col-start-1 row-start-1 h-full w-full px-16 py-8">
			<div class="grid grid-rows-[1fr_3.5em] h-full w-full overflow-x-visible">
				{@render children()}
			</div>
		</div>
	</div>
</div>

<style>
	/* Animation for the sine wave */
	@keyframes waveAnimation {
		0% {
			transform: translateX(0);
		}
		100% {
			transform: translateX(-50%); /* Move left by the width of the wave */
		}
	}

	.animate-wave {
		animation: waveAnimation 10s linear infinite;
	}

	/* Optional: Add some styles for the sine wave */
	svg {
		z-index: 1;
	}
</style>
